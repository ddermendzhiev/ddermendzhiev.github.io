<!DOCTYPE html>
<html
  lang="en"
  dir="ltr"
  
><meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">


<title>Inspect the Memory Image | Memory Forensics on ML Processes | Dinko Dermendzhiev</title>

<meta name="generator" content="Hugo Eureka 0.9.3" />
<link rel="stylesheet" href="https://ddermendzhiev.github.io/css/eureka.min.9cec6350e37e534b0338fa9a085bf06855de3b0f2dcf857e792e5e97b07ea905d4d5513db554cbc26a9c3da622bae92d.css">
<script defer src="https://ddermendzhiev.github.io/js/eureka.min.fa9a6bf6d7a50bb635b4cca7d2ba5cf3dfb095ae3798773f1328f7950028b48c17d06276594e1b5f244a25a6c969a705.js"></script>













<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link rel="preload"
  href="https://fonts.googleapis.com/css2?family=Lora:wght@400;600;700&amp;family=Noto&#43;Serif&#43;SC:wght@400;600;700&amp;display=swap"
  as="style" onload="this.onload=null;this.rel='stylesheet'">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.4.0/build/styles/base16/solarized-light.min.css"
   media="print"
  onload="this.media='all';this.onload=null" crossorigin>
<script defer src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.4.0/build/highlight.min.js"
   crossorigin></script>
  <script defer src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.4.0/build/languages/dart.min.js"
     crossorigin></script>
<link rel="stylesheet" href="https://ddermendzhiev.github.io/css/highlightjs.min.2958991528e43eb6fc9b8c4f2b8e052f79c4010718e1d1e888a777620e9ee63021c2c57ec7417a3108019bb8c41943e6.css" media="print" onload="this.media='all';this.onload=null">


<script defer type="text/javascript" src="https://ddermendzhiev.github.io/js/fontawesome.min.2eec90e3a2d89beec3a0edb9d29a99ba8e768e800e6177c4300e215277073b35c0ef2b862438363ac7b09eff2084dc3f.js"></script>


<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css"
   integrity="sha384-MlJdn/WNKDGXveldHDdyRP1R4CTHr3FeuDNfhsLPYrq2t0UBkUdK2jyTnXPEK1NQ"  media="print"
  onload="this.media='all';this.onload=null" crossorigin>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.js" 
  integrity="sha384-VQ8d8WVFw0yHhCk5E8I86oOhv48xLpnDZx5T9GogA/Y84DcCKWXDmSDfn13bzFZY"  crossorigin></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/contrib/auto-render.min.js"
   integrity="sha384-&#43;XBljXPPiv&#43;OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR"  crossorigin></script>
<script>
  document.addEventListener("DOMContentLoaded", function () {
    renderMathInElement(document.body, {
      delimiters: [
        { left: "$$", right: "$$", display: true },
        { left: "$", right: "$", display: false },
        { left: "\\(", right: "\\)", display: false },
        { left: "\\[", right: "\\]", display: true }
      ],
    });
  });
</script>


<script defer src="https://cdn.jsdelivr.net/npm/mermaid@8.14.0/dist/mermaid.min.js" 
  integrity="sha384-atOyb0FxAgN9LyAc6PEf9BjgwLISyansgdH8/VXQH8p2o5vfrRgmGIJ2Sg22L0A0"  crossorigin></script>



<meta name="description"
  content="Acquiring symbol files and running Volatility3 plugins.">
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [{
      "@type": "ListItem",
      "position": 1 ,
      "name":"Docs",
      "item":"https://ddermendzhiev.github.io/docs/"},{
      "@type": "ListItem",
      "position": 2 ,
      "name":"Memory Forensics on ML Processes",
      "item":"https://ddermendzhiev.github.io/docs/memoryforensicsonml/"},{
      "@type": "ListItem",
      "position": 3 ,
      "name":"Inspect the Memory Image",
      "item":"https://ddermendzhiev.github.io/docs/memoryforensicsonml/chapter-4/"}]
}
</script>



<script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://ddermendzhiev.github.io/docs/memoryforensicsonml/chapter-4/"
    },
    "headline": "Inspect the Memory Image | Memory Forensics on ML Processes | Dinko Dermendzhiev","datePublished": "2023-06-01T00:00:00+00:00",
    "dateModified": "2023-06-01T00:00:00+00:00",
    "wordCount":  926 ,
    "publisher": {
        "@type": "Person",
        "name": "Dinko Dermendzhiev",
        },
    "description": "Acquiring symbol files and running Volatility3 plugins."
}
</script><meta property="og:title" content="Inspect the Memory Image | Memory Forensics on ML Processes | Dinko Dermendzhiev" />
<meta property="og:type" content="article" />



<meta property="og:url" content="https://ddermendzhiev.github.io/docs/memoryforensicsonml/chapter-4/" />



<meta property="og:description" content="Acquiring symbol files and running Volatility3 plugins." />



<meta property="og:locale" content="en" />




<meta property="og:site_name" content="Dinko Dermendzhiev" />






<meta property="article:published_time" content="2023-06-01T00:00:00&#43;00:00" />


<meta property="article:modified_time" content="2023-06-01T00:00:00&#43;00:00" />



<meta property="article:section" content="docs" />





  <body class="flex min-h-screen flex-col">
    <header
      class="min-h-16 pl-scrollbar bg-secondary-bg fixed z-50 flex w-full items-center shadow-sm"
    >
      <div class="mx-auto w-full max-w-screen-xl"><script>
    let storageColorScheme = localStorage.getItem("lightDarkMode")
    if (((storageColorScheme == 'Auto' || storageColorScheme == null) && window.matchMedia("(prefers-color-scheme: dark)").matches) || storageColorScheme == "Dark") {
        document.getElementsByTagName('html')[0].classList.add('dark')
    }
</script>
<nav class="flex items-center justify-between flex-wrap px-4 py-4 md:py-0">
    <a href="/" class="me-6 text-primary-text text-xl font-bold">Dinko Dermendzhiev</a>
    <button id="navbar-btn" class="md:hidden flex items-center px-3 py-2" aria-label="Open Navbar">
        <i class="fas fa-bars"></i>
    </button>

    <div id="target"
        class="hidden block md:flex md:grow md:justify-between md:items-center w-full md:w-auto text-primary-text z-20">
        <div class="md:flex md:h-16 text-sm md:grow pb-4 md:pb-0 border-b md:border-b-0">
            <a href="/docs/" class="block mt-4 md:inline-block md:mt-0 md:h-(16-4px) md:leading-(16-4px) box-border md:border-t-2 md:border-b-2  selected-menu-item  me-4">Docs</a>
        </div>

        <div class="flex">
            <div class="relative pt-4 md:pt-0">
                <div class="cursor-pointer hover:text-eureka" id="lightDarkMode">
                    <i class="fas fa-adjust"></i>
                </div>
                <div class="fixed hidden inset-0 opacity-0 h-full w-full cursor-default z-30" id="is-open">
                </div>
                <div class="absolute flex flex-col start-0 md:start-auto end-auto md:end-0 hidden bg-secondary-bg w-48 rounded py-2 border border-tertiary-bg cursor-pointer z-40"
                    id='lightDarkOptions'>
                    <span class="px-4 py-1 hover:text-eureka" name="Light">Light</span>
                    <span class="px-4 py-1 hover:text-eureka" name="Dark">Dark</span>
                    <span class="px-4 py-1 hover:text-eureka" name="Auto">Auto</span>
                </div>
            </div>
        </div>
    </div>

    <div class="fixed hidden inset-0 opacity-0 h-full w-full cursor-default z-0" id="is-open-mobile">
    </div>

</nav>
<script>
    
    let element = document.getElementById('lightDarkMode')
    if (storageColorScheme == null || storageColorScheme == 'Auto') {
        document.addEventListener('DOMContentLoaded', () => {
            window.matchMedia("(prefers-color-scheme: dark)").addEventListener('change', switchDarkMode)
        })
    } else if (storageColorScheme == "Light") {
        element.firstElementChild.classList.remove('fa-adjust')
        element.firstElementChild.setAttribute("data-icon", 'sun')
        element.firstElementChild.classList.add('fa-sun')
    } else if (storageColorScheme == "Dark") {
        element.firstElementChild.classList.remove('fa-adjust')
        element.firstElementChild.setAttribute("data-icon", 'moon')
        element.firstElementChild.classList.add('fa-moon')
    }

    document.addEventListener('DOMContentLoaded', () => {
        getcolorscheme();
        switchBurger();
    });
</script>
</div>
    </header>
    <main class="grow pt-16">
        <div class="pl-scrollbar">
          <div class="mx-auto w-full max-w-screen-xl lg:px-4 xl:px-8">


<div class="lg:pt-12">
    <div class="flex flex-col md:flex-row bg-secondary-bg rounded">
        <div class="md:w-1/4 lg:w-1/5 border-e">
            <div class="sticky top-16 pt-6">
                










<div id="sidebar-title" class="md:hidden mx-4 px-2 pt-4 pb-2 md:border-b text-tertiary-text md:text-primary-text">
    <span class="font-semibold">Table of Contents</span>
    <i class='fas fa-caret-right ms-1'></i>
</div>

<div id="sidebar-toc"
    class="hidden md:block overflow-y-auto mx-6 md:mx-0 pe-6 pt-2 md:max-h-doc-sidebar bg-primary-bg md:bg-transparent">
    <div class="flex flex-wrap ms-4 -me-2 p-2 bg-secondary-bg md:bg-primary-bg rounded">
        <a class=" hover:text-eureka"
            href="https://ddermendzhiev.github.io/docs/memoryforensicsonml/">Memory Forensics on ML Processes</a>
        
        
        


    </div>
    
<ul class="ps-6">
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="https://ddermendzhiev.github.io/docs/memoryforensicsonml/chapter-1/">Build a Convolutional Neural Network</a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="https://ddermendzhiev.github.io/docs/memoryforensicsonml/chapter-2/">Inspect the Running Python ML Process</a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="https://ddermendzhiev.github.io/docs/memoryforensicsonml/chapter-3/">Gather a Memory Image of the System</a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" text-eureka  hover:text-eureka"
                href="https://ddermendzhiev.github.io/docs/memoryforensicsonml/chapter-4/">Inspect the Memory Image</a>
        </div>
        
    </li>
    
    
    
    
    <li class="py-2">
        <div class="">
            <a class=" hover:text-eureka"
                href="https://ddermendzhiev.github.io/docs/memoryforensicsonml/chapter-5/">Develop a Volatility Plugin to Recover ML Models</a>
        </div>
        
    </li>
    
    
</ul>

</div>





            </div>

        </div>
        <div class="w-full md:w-3/4 lg:w-4/5 pb-8 pt-2 md:pt-8">
            <div class="flex">
                <div class="w-full lg:w-3/4 px-6">
                    <article class="prose">
  <h1 class="mb-4">Inspect the Memory Image</h1>

  <div
  class="text-tertiary-text not-prose mt-2 flex flex-row flex-wrap items-center"
>
  <div class="me-6 my-2">
    <i class="fas fa-calendar me-1"></i>
    <span
      >2023-06-01</span
    >
  </div>
  <div class="me-6 my-2">
    <i class="fas fa-clock me-1"></i>
    <span>5 min read</span>
  </div>

  

  
</div>


  
  

  <ol>
<li>Make sure you have Volatility cloned and setup.</li>
</ol>
<p><strong>Note:</strong> You will be using the current standard, Volatility3. Once cloned locally, you will see the volatility3 directory, which contains everything you need. Run the following commands to setup Volatility3 with full functionality.</p>
<pre><code class="language-shell">/volatility3$ pip3 install -r requirements.txt
</code></pre>
<ol start="2">
<li>Now, you must make sure Volatility3 has access to an ISF file (interactive symbol format) of the target system kernel. Simply put, this is a mapping of how and where the kernel stores it&rsquo;s information. It is required by Volatility plugins to produce correct results. First, get the kernel build.</li>
</ol>
<pre><code class="language-shell">$ uname -a
Linux dinko-virtual-machine 5.19.0-38-generic #39~22.04.1-Ubuntu SMP PREEMPT_DYNAMIC Fri Mar 17 21:16:15 UTC 2 x86_64 x86_64 x86_64 GNU/Linux
</code></pre>
<ol start="3">
<li>
<p>Begin by looking for the ISF file onine. Start by searching on this <a href="https://isf-server.techanarchy.net/">server</a>. If you found it, jump ahead to step 8. Else, you must make your own, as follows.</p>
</li>
<li>
<p>An ISF file <a href="https://volatility3.readthedocs.io/en/latest/symbol-tables.html">can be made</a> using a kernel debug symbols file (format=<a href="https://en.wikipedia.org/wiki/DWARF">DWARF</a>). Due to size, operating systems tend to exclude the installation of the debug kernel. Nonetheless, you might as well check in <em>/usr/lib/debug/boot/</em> for an ELF file named after your kernel build. Use the <em>file</em> command and note that the file is with debug info and not stripped.</p>
</li>
</ol>
<pre><code class="language-shell">/usr/lib/debug/boot# file vmlinux-5.19.0-38-generic 
vmlinux-5.19.0-38-generic: ELF 64-bit LSB executable, x86-64, version 1 (SYSV), statically linked, BuildID[sha1]=51a9c7ec33e823c440a8c6a9ce6bd12697867c10, with debug_info, not stripped
</code></pre>
<ol start="5">
<li>If you found the debug kernel in the previous step, move on to step 7. Else, you will need to download it. If you are using Ubuntu, you can benefit from their official repository of debug symbols. As per the <a href="https://wiki.ubuntu.com/Debug%20Symbol%20Packages#Getting_-dbgsym.ddeb_packages">Ubuntu wiki</a>, run the following four commands to enable the repository.</li>
</ol>
<p><strong>Note:</strong> For other distros, look to their respective documentation/forum for information on kernel debug symbols.</p>
<pre><code class="language-shell">$ echo &quot;deb http://ddebs.ubuntu.com $(lsb_release -cs) main restricted universe multiverse
deb http://ddebs.ubuntu.com $(lsb_release -cs)-updates main restricted universe multiverse
deb http://ddebs.ubuntu.com $(lsb_release -cs)-proposed main restricted universe multiverse&quot; | sudo tee -a /etc/apt/sources.list.d/ddebs.list
$ sudo apt install ubuntu-dbgsym-keyring
$ sudo apt-get update
</code></pre>
<ol start="6">
<li>Install your kernel debug symbols file.</li>
</ol>
<pre><code class="language-shell">$ sudo apt-get install linux-image-`uname -r`-dbgsym
</code></pre>
<ol start="7">
<li>After installation is complete, repeat step 4 and check that the file was successfully installed. Now use <a href="https://github.com/volatilityfoundation/dwarf2json">dwarf2json</a> to interpret the debug kernel and create the ISF in JSON format, as required by Volatility3.</li>
</ol>
<p><strong>Note:</strong> Pass in the <em>System.map</em>, which should already be resident on your machine. This is another file that contains a mapping of symbols to their locations in memory. According to the dwarf2json <a href="https://github.com/volatilityfoundation/dwarf2json/blob/master/README.md?plain=1#L53">documentation</a>, the <em>System.map</em> symbols will take highest precedence. This is favorable as it surely contains the correct symbol mapping for your build (it is a product of your kernel&rsquo;s compilation).</p>
<pre><code class="language-shell">$ [PATH_INTO_DWARF2JSON_REPO]/dwarf2json linux --elf /usr/lib/debug/boot/vmlinux-5.19.0-38-generic --system-map /boot/System.map-5.19.0-38-generic &gt; volatility3/volatility3/symbols/linux/vmlinux-5.19.0-38-generic-new.json
</code></pre>
<p><strong>Note:</strong> If the command line returns &lsquo;Killed&rsquo;, the problem is likely insufficient memory. Allocate 8GB of RAM to the VM for this step to work.</p>
<ol start="8">
<li>Verify that the ISF JSON is in the <em>symbols/linux/</em> directory and that it is not empty.</li>
</ol>
<pre><code class="language-shell">/volatility3$ file volatility3/symbols/linux/vmlinux-5.19.0-38-generic-new.json 
vmlinux-5.19.0-38-generic-new.json: ASCII text
</code></pre>
<ol start="9">
<li>To make sure that Volatility detects the new symbols file and it is the correct file, run the <strong>isfinfo</strong> plugin and cross-reference with the output of the <strong>banners</strong> plugin. They must match to a tee. That includes the kernel, compiler, architecture, and time of compilation.</li>
</ol>
<pre><code class="language-shell">/volatility3$ python3 vol.py -vvvv -f ../LiME/Linux64.mem isfinfo
file:///opt/volatility3/volatility3/symbols/linux/vmlinux-5.19.0-38-generic-new.json	Unknown	19	12229	201844	2214	b'Linux version 5.19.0-38-generic (buildd@lcy02-amd64-001) (x86_64-linux-gnu-gcc (Ubuntu 11.3.0-1ubuntu1~22.04) 11.3.0, GNU ld (GNU Binutils for Ubuntu) 2.38) #39~22.04.1-Ubuntu SMP PREEMPT_DYNAMIC Fri Mar 17 21:16:15 UTC 2 (Ubuntu 5.19.0-38.39~22.04.1-generic 5.19.17)\n\x00'

/volatility3$ python3 vol.py -f ../LiME/Linux64.mem banners
Volatility 3 Framework 2.4.2
Progress:  100.00		PDB scanning finished                      
Offset	Banner

0xc8b6da40	Linux version 5.19.0-38-generic (buildd@lcy02-amd64-001) (x86_64-linux-gnu-gcc (Ubuntu 11.3.0-1ubuntu1~22.04) 11.3.0, GNU ld (GNU Binutils for Ubuntu) 2.38) #39~22.04.1-Ubuntu SMP PREEMPT_DYNAMIC Fri Mar 17 21:16:15 UTC 2 (Ubuntu 5.19.0-38.39~22.04.1-generic 5.19.17)
0xc9f20d00	Linux version 5.19.0-38-generic (buildd@lcy02-amd64-001) (x86_64-linux-gnu-gcc (Ubuntu 11.3.0-1ubuntu1~22.04) 11.3.0, GNU ld (GNU Binutils for Ubuntu) 2.38) #39~22.04.1-Ubuntu SMP PREEMPT_DYNAMIC Fri Mar 17 21:16:15 UTC 2 (Ubuntu 5.19.0-38.39~22.04.1-generic 5.19.17)7)
0xffe350c8	Linux version 5.19.0-38-generic (buildd@lcy02-amd64-001) (x86_64-linux-gnu-gcc (Ubuntu 11.3.0-1ubuntu1~22.04) 11.3.0, GNU ld (GNU Binutils for Ubuntu) 2.38) #39~22.04.1-Ubuntu SMP PREEMPT_DYNAMIC Fri Mar 17 21:16:15 UTC 2 (Ubuntu 5.19.0-38.39~22.04.1-generic 5
</code></pre>
<p>Finally, you can begin running image-specific plugins on the memory acquisition using this template command.</p>
<pre><code class="language-shell">/volatility3$ python3 vol.py -f &lt;path to memory image&gt; &lt;plugin_name&gt; &lt;plugin_option&gt;
</code></pre>
<p>Run with the <em>-h</em> flag to see all the available plugins. Spend some time here, before proceeding to the next steps, playing around with the Linux plugins and getting familiar with their outputs.</p>
<pre><code class="language-shell">/volatility3$ python3 vol.py -h
</code></pre>
<ol start="11">
<li>Try to find your old friend, the ML process. Run the <strong>pslist</strong> plugin, filtering by the PID, to display some basic information about the process.</li>
</ol>
<pre><code class="language-shell">/volatility3$ python3 vol.py -f ../LiME/images/memdump.lime linux.pslist --pid 3391
</code></pre>
<p><img src="/pslist-PID.png" alt="image"></p>
<ol start="12">
<li>Then run the <strong>proc</strong> plugin to list memory maps, again filtering by the PID. Here you can see the virtual memory mappings of the process. Also known as VMAs (virtual memory areas), these provide the information needed to translate virtual addresses to physical addresses.</li>
</ol>
<p><strong>Note:</strong> This output is valuable because you can now locate various Python structures in the memory image by accessing known offsets inside the VMAs.</p>
<pre><code class="language-shell">/volatility3$ python3 vol.py -f ../LiME/images/memdump.lime linux.proc --pid 3391
</code></pre>
<p><img src="/MemoryMapping.jpg" alt="image"></p>
<p>You will see hundreds of VMAs, but notice that the first ones correspond to the Python3 executable itself. Python is an interpreted language, therefore the exe is the interpreter. The exe manages the state of the program as it interprets your Python script, so you can expect to find data structures that track objects, for example. You will locate all of this information within the ELF&rsquo;s VMAs which, in this case, begin at 0x555555554000.</p>

</article>

                    
                    
                    

                    



                    
  <div
    class="-mx-2 mt-4 flex flex-col border-t px-2 pt-4 md:flex-row md:justify-between"
  >
    <div>
      
        <span class="text-primary-text block font-bold"
          >Previous</span
        >
        <a href="https://ddermendzhiev.github.io/docs/memoryforensicsonml/chapter-3/" class="block">Gather a Memory Image of the System</a>
      
    </div>
    <div class="mt-4 md:mt-0 md:text-right">
      
        <span class="text-primary-text block font-bold">Next</span>
        <a href="https://ddermendzhiev.github.io/docs/memoryforensicsonml/chapter-5/" class="block">Develop a Volatility Plugin to Recover ML Models</a>
      
    </div>
  </div>


                    



                </div>
                
            </div>

        </div>


    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', () => {
        
        hljs.highlightAll();
        changeSidebarHeight();
        switchDocToc();
    })
</script>









          </div>
        </div>
      
    </main>
    <footer class="pl-scrollbar">
      <div class="mx-auto w-full max-w-screen-xl"><div class="text-center p-6 pin-b">
    <p class="text-sm text-tertiary-text"> Powered by the <a href="https://github.com/wangchucheng/hugo-eureka" class="hover:text-eureka">Eureka</a> theme for <a href="https://gohugo.io" class="hover:text-eureka">Hugo</a></p>
</div></div>
    </footer>
  </body>
</html>
